@page
@model CRM.Web.Pages.Finance.PaymentPlans.IndexModel
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<SharedResource> Localizer

@{
    Layout = "_DashboardLayout";
    ViewData["Title"] = Localizer["Finance_PaymentPlans_Page_Title"];
}

@section Styles {
    <link rel="stylesheet" href="~/css/finance/payment-plans/list.css" asp-append-version="true" />
}

<section class="page-header paymentplans-header">
    <div>
        <h1>@Localizer["Finance_PaymentPlans_Page_Title"]</h1>
        <p class="subtitle">@Localizer["Finance_PaymentPlans_Page_Subtitle"]</p>
    </div>
    <div class="header-actions">
        <a class="btn btn-primary" asp-page="Create">@Localizer["Finance_PaymentPlans_Action_Create"]</a>
    </div>
</section>

<section class="paymentplans-filter">
    <form method="get" class="filter-form">
        <label class="search-control">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" width="18" height="18">
                <circle cx="11" cy="11" r="7" />
                <path d="m20 20-3.5-3.5" />
            </svg>
            <input type="search"
                   name="customer"
                   value="@Model.CustomerFilter"
                   placeholder="@Localizer["Finance_PaymentPlans_Search_Placeholder"].Value" />
        </label>
        <div class="filter-actions">
            <button type="submit" class="btn btn-primary">@Localizer["Finance_Cashbox_Filter_Search"]</button>
            <a class="btn btn-ghost" asp-page="Index">@Localizer["Finance_Cashbox_Filter_Clear"]</a>
        </div>
    </form>
</section>

<section class="paymentplans-table-section">
    <article class="card table-card wide">
        <header class="card-header">
            <div>
                <h2>@Localizer["Finance_PaymentPlans_Table_Title"]</h2>
                <p>@Localizer["Finance_PaymentPlans_Table_Subtitle"]</p>
            </div>
        </header>
        <div class="table-wrapper">
            <table id="paymentPlansTable" class="data-table" data-order-column="4" data-order-direction="desc">
                <thead>
                    <tr>
                        <th>@Localizer["Finance_PaymentPlans_Field_PlanId"]</th>
                        <th>@Localizer["Finance_PaymentPlans_Field_Customer"]</th>
                        <th>@Localizer["Finance_PaymentPlans_Field_Shipment"]</th>
                        <th>@Localizer["Finance_PaymentPlans_Field_Type"]</th>
                        <th>@Localizer["Finance_PaymentPlans_Field_Total"]</th>
                        <th>@Localizer["Finance_PaymentPlans_Field_StartDate"]</th>
                        <th class="text-end">@Localizer["Customers_Table_Actions"]</th>
                    </tr>
                </thead>
                <tbody>
                @foreach (var plan in Model.Plans)
                {
                    <tr>
                        <td>@plan.Id</td>
                        <td>
                            <div class="cell-strong">@plan.CustomerName</div>
                        </td>
                        <td>@plan.ShipmentReference</td>
                        <td>@plan.PlanType</td>
                        <td>
                            <div class="cell-strong">@plan.TotalAmount.ToString("C2")</div>
                            <div class="cell-subtext">@plan.Currency</div>
                        </td>
                        <td>@plan.StartDate.ToString("d")</td>
                        <td class="text-end">
                            <a class="btn btn-icon" asp-page="Details" asp-route-id="@plan.Id" title="@Localizer["Customers_Action_Details"]">
                                <img src="~/images/detail.png" alt="@Localizer["Customers_Action_Details"]" width="18" height="18" loading="lazy" />
                            </a>
                        </td>
                    </tr>
                }
                @if (!Model.Plans.Any())
                {
                    <tr>
                        <td colspan="7" class="empty-state">@Localizer["Finance_PaymentPlans_Table_NoRecords"]</td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
    </article>
</section>

@section Scripts {
    <script src="~/js/finance/payment-plans/list.js" asp-append-version="true"></script>
}

